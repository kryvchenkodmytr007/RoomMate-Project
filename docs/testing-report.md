# Лабораторна робота №5 — Звіт про тестування

## Що покрито

У проєкті реалізовано 3 рівні тестування:

1. **Unit-тести (модульні)** — чисті доменні правила в `packages/shared/src/logic/*`.
   - Перевірки коректності діапазону бюджету (`budgetRangeViolation`).
   - Перевірка, що `fromProfileId` та `toProfileId` різні (`differentIdsViolation`).

2. **Integration-тести** — HTTP-обробники сервісів + реальна база даних (PostgreSQL у Docker).
   - `apps/profiles-service/src/__tests__/profiles.test.ts` (POST/GET профілі).
   - `apps/matches-service/src/__tests__/matches.test.ts` (створення match-request, зміна статуса).

3. **E2E-тест** — піднімає **обидва** сервіси як окремі процеси (реальні HTTP-сервери) + PostgreSQL, та проганяє повний сценарій:
   - створення 2 профілів → створення match-request → зміна статусу → перевірка списку.
   - файл: `tests/e2e/roommate.e2e.test.ts`.

## Як запускати

1. Підняти залежності та підготувати тестову БД:

```bash
pnpm test:setup
```

2. Unit + integration тести (Vitest):

```bash
pnpm test
```

3. E2E:

```bash
pnpm test:e2e
```

## Мутаційне тестування (Stryker)

Для вимірювання якості покриття unit-тестів використано **Stryker**.

Запуск:

```bash
pnpm test:mutation
```

Результати:

- HTML-звіт: `reports/mutation/html/index.html` (створюється Stryker).

### Висновок (коротко)

- Unit-тести покривають ключові доменні правила, які впливають на валідацію запитів.
- Integration тести перевіряють роботу HTTP-ендпоінтів із реальною БД.
- E2E тест перевіряє роботу системи як цілого (взаємодія двох сервісів через спільну БД).

Що можна покращити далі:

- додати unit-тести на edge-cases (порожні строки, довжини, тощо) для схем валідації;
- розширити E2E на негативні сценарії (404, 409, 400);
- зробити окремий “seed” для тестової БД і стабілізувати дані між тестами.
